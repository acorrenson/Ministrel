loop
  abort
    { await A || await B };
    emit O;
    halt
  when R
end